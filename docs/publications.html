<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Publications – Stephen J Eglen</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-707d8167ce6003fca903bfe2be84ab7f.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f93c2b1f3f0577f377aefa4848a86a36.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-0d4a9d19931feb4fee1ddab4b2489000.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-f93c2b1f3f0577f377aefa4848a86a36.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Stephen J Eglen</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./publications.html" aria-current="page"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./open.html"> 
<span class="menu-text">Open research</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#preprints" id="toc-preprints" class="nav-link active" data-scroll-target="#preprints">Preprints</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">2025</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1">2024</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2">2023</a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3">2022</a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4">2021</a></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5">2020</a></li>
  <li><a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6">2019</a></li>
  <li><a href="#section-7" id="toc-section-7" class="nav-link" data-scroll-target="#section-7">2018</a></li>
  <li><a href="#section-8" id="toc-section-8" class="nav-link" data-scroll-target="#section-8">2017</a></li>
  <li><a href="#section-9" id="toc-section-9" class="nav-link" data-scroll-target="#section-9">2016</a></li>
  <li><a href="#section-10" id="toc-section-10" class="nav-link" data-scroll-target="#section-10">2015</a></li>
  <li><a href="#section-11" id="toc-section-11" class="nav-link" data-scroll-target="#section-11">2014</a></li>
  <li><a href="#section-12" id="toc-section-12" class="nav-link" data-scroll-target="#section-12">2013</a></li>
  <li><a href="#section-13" id="toc-section-13" class="nav-link" data-scroll-target="#section-13">2012</a></li>
  <li><a href="#section-14" id="toc-section-14" class="nav-link" data-scroll-target="#section-14">2011</a></li>
  <li><a href="#section-15" id="toc-section-15" class="nav-link" data-scroll-target="#section-15">2009</a></li>
  <li><a href="#section-16" id="toc-section-16" class="nav-link" data-scroll-target="#section-16">2008</a></li>
  <li><a href="#section-17" id="toc-section-17" class="nav-link" data-scroll-target="#section-17">2006</a></li>
  <li><a href="#section-18" id="toc-section-18" class="nav-link" data-scroll-target="#section-18">2005</a></li>
  <li><a href="#section-19" id="toc-section-19" class="nav-link" data-scroll-target="#section-19">2003</a></li>
  <li><a href="#section-20" id="toc-section-20" class="nav-link" data-scroll-target="#section-20">2002</a></li>
  <li><a href="#section-21" id="toc-section-21" class="nav-link" data-scroll-target="#section-21">2000</a></li>
  <li><a href="#section-22" id="toc-section-22" class="nav-link" data-scroll-target="#section-22">1999</a></li>
  <li><a href="#section-23" id="toc-section-23" class="nav-link" data-scroll-target="#section-23">1997</a></li>
  <li><a href="#section-24" id="toc-section-24" class="nav-link" data-scroll-target="#section-24">1996</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Publications</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>After each reference, <em>Paper</em> links to papers; <em>Info</em> to further information about that paper, including code and data.</p>
<section id="preprints" class="level3">
<h3 class="anchored" data-anchor-id="preprints">Preprints</h3>
<p>Lyngholm D, Sterratt DC, Johannes Hjorth JJ, Willshaw DJ, Eglen SJ, Thompson ID (2019) Measuring and modelling the emergence of order in the mouse retinocollicular projection. bioRxiv:713628 <a href="https://doi.org/10.1101/713628"><em>Paper</em></a> <a href="http://github.com/sje30/b2"><em>Info</em></a>.</p>
<p>Lonborg AV, Eglen SJ (2017) A mechanistic model of the spatial interaction between blue cones and blue cone bipolar cells in macaque retina. bioRxiv:129643 <a href="http://biorxiv.org/content/early/2017/04/22/129643"><em>Paper</em></a></p>
<p>Cutts CS, Eglen SJ (2016) A Bayesian framework for comparing the structure of spontaneous correlated activity recorded under different conditions. bioRxiv:037358 <a href="http://biorxiv.org/content/early/2016/01/19/037358"><em>Paper</em></a></p>
<p>Reprints for papers already published are also available by searching on <a href="http://biorxiv.org/search/eglen">biorxiv</a>.</p>
</section>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">2025</h3>
<p>Akarca D, Dunn AWE, Hornauer PJ, Ronchi S, Fiscella M, Wang C, Terrigno M, Jagasia R, Vértes PE, Mierau SB, Paulsen O, Eglen SJ, Hierlemann A, Astle DE, Schröter M (2025) Homophilic wiring principles underpin neuronal network topology in vitro. Elife 14 <a href="http://dx.doi.org/10.7554/eLife.85300"><em>Paper</em></a> <a href="https://github.com/DanAkarca/MEA_generative_models"><em>Code</em></a>.</p>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">2024</h3>
<p>Sit TPH et al.&nbsp;(2024) MEA-NAP: A flexible network analysis pipeline for neuronal 2D and 3D organoid multielectrode recordings. Cell Rep Methods 4:100901 <a href="https://pubmed.ncbi.nlm.nih.gov/39520988/">Paper</a> <a href="https://github.com/SAND-Lab/MEA-NAP">Code</a></p>
<p>Schmausser M, Holland A, Beresford-Webb J, Eglen SJ, Manning K, Aman L, Kronhaus D, Koenig J (2024) Effects of long-term transcutaneous auricular vagus nerve stimulation on circadian vagal activity in people with Prader-Willi Syndrome: A case-series. Res Dev Disabil 154:104855 <a href="https://pubmed.ncbi.nlm.nih.gov/39405838/">Paper</a></p>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2">2023</h3>
<p>Edinburgh T, Ercole A, Eglen S (2023) Bayesian model selection for multilevel models using integrated likelihoods. PLoS One 18:e0280046 <a href="http://dx.doi.org/10.1371/journal.pone.0280046">Paper</a> <a href="https://github.com/tedinburgh/model-evidence-with-integrated-likelihood">Code</a></p>
</section>
<section id="section-3" class="level3">
<h3 class="anchored" data-anchor-id="section-3">2022</h3>
<p>N Gale, J Rodger, M Small, S Eglen (2022) Analysis of activity dependent development of topographic maps in neural field theory with short time scale dependent plasticity. Mathematical Neuroscience and Applications 2 <a href="https://mna.episciences.org/8390"><em>Paper</em></a> <a href="https://github.com/Nick-Gale/Neural_Field_Theory_Topopgraphic_Development"><em>Code</em></a>.</p>
<p>T Edinburgh, SJ Eglen, P Thoral, P Elbers, A Ercole (2022) Sepsis-3 criteria in AmsterdamUMCdb: open-source code implementation. Gigabyte 2022:1–7 <a href="https://gigabytejournal.com/articles/45"><em>Paper</em></a> <a href="https://github.com/tedinburgh/sepsis3-amsterdamumcdb"><em>Code</em></a>.</p>
</section>
<section id="section-4" class="level3">
<h3 class="anchored" data-anchor-id="section-4">2021</h3>
<p>Edinburgh T, Eglen SJ, Ercole A (2021) Causality indices for bivariate time series data: A comparative review of performance. Chaos 31:083111 <a href="https://doi.org/10.1063/5.0053519"><em>Paper</em></a> <a href="https://github.com/tedinburgh/causality-review"><em>Code</em></a>.</p>
<p>Edinburgh T, Smielewski P, Czosnyka M, Cabeleira M, Eglen SJ, Ercole A (2021) DeepClean: Self-Supervised Artefact Rejection for Intensive Care Waveform Data Using Deep Generative Learning. In: Intracranial Pressure and Neuromonitoring XVII, pp 235–241 Acta Neurochirurgica Supplement. <a href="https://arxiv.org/abs/1908.03129"><em>Paper</em></a>.</p>
<p>Nüst D, Eglen SJ (2021) CODECHECK: an Open Science initiative for the independent execution of computations underlying research articles during peer review to improve reproducibility. F1000Res 10:253 <a href="http://dx.doi.org/10.12688/f1000research.51738.2"><em>Paper</em></a>.</p>
<p>Eglen SJ (2021) [Re] Spatial constraints underlying the retinal mosaics of two types of horizontal cells in cat and macaque. Rescience C 6:22 <a href="https://zenodo.org/record/5347786"><em>Paper</em></a>.</p>
</section>
<section id="section-5" class="level3">
<h3 class="anchored" data-anchor-id="section-5">2020</h3>
<p>Nüst D, Sochat V, Marwick B, Eglen SJ, Head T, Hirst T, Evans BD (2020) Ten simple rules for writing Dockerfiles for reproducible data science. PLoS Comput Biol 16:e1008316 <a href="http://dx.doi.org/10.1371/journal.pcbi.1008316"><em>Paper</em></a>.</p>
<p>Keeley PW, Eglen SJ, Reese BE (2020) From Random to Regular: Variation in the Patterning of Retinal Mosaics. J Comp Neurol 528:2135-2160. <a href="http://dx.doi.org/10.1002/cne.24880"><em>Paper</em></a>. <a href="http://arxiv.org/abs/1910.10210"><em>Preprint</em></a>.</p>
</section>
<section id="section-6" class="level3">
<h3 class="anchored" data-anchor-id="section-6">2019</h3>
<p>Hyvärinen T, Hyysalo A, Kapucu FE, Aarnos L, Vinogradov A, Eglen SJ, Ylä-Outinen L, Narkilahti S (2019) Functional characterization of human pluripotent stem cell-derived cortical networks differentiated on laminin-521 substrate: comparison to rat cortical cultures. Sci Rep 9:17125 <a href="https://doi.org/10.1038/s41598-019-53647-8">Paper</a>.</p>
<p>Cotterill E, Eglen SJ (2019) Burst Detection Methods. In: In Vitro Neuronal Networks, From Culturing Methods to Neuro-Technological Applications, pp 185–206 <a href="https://arxiv.org/abs/1802.01287"><em>Paper</em></a>.</p>
</section>
<section id="section-7" class="level3">
<h3 class="anchored" data-anchor-id="section-7">2018</h3>
<p>Eglen SJ, Mounce R, Gatto L, Currie AM, Nobis Y (2018) Recent developments in scholarly publishing to improve research practices in the life sciences. Emerg Top Life Sci 2:775–778 <a href="http://www.emergtoplifesci.org/lookup/doi/10.1042/ETLS20180172"><em>Paper</em></a></p>
<p>Gelfman S, Wang Q, Lu Y-F, Hall D, Bostick C, Dhindsa R, Halvorsen M, Melodi McSweeney K, Cotterill E, Edinburgh T, Petrovski S, Boland MJ, Allen AS, Goldstein DB, Eglen SJ (2018) meaRtools: an R package for the analysis of neuronal networks recorded on microelectrode arrays. PLOS Comput Biol 14:e1006506. <a href="https://doi.org/10.1371/journal.pcbi.1006506"><em>Paper</em></a> <a href="https://cran.r-project.org/web/packages/meaRtools/index.html"><em>Code</em></a></p>
</section>
<section id="section-8" class="level3">
<h3 class="anchored" data-anchor-id="section-8">2017</h3>
<p>Eglen SJ, Marwick B, Halchenko YO, Hanke M, Sufi S, Gleeson P, Angus Silver R, Davison AP, Lanyon L, Abrams M, Wachtler T, Willshaw DJ, Pouzat C, Poline J-B (2017) Toward standard practices for sharing computer code and programs in neuroscience. Nat Neurosci 20:770–773. <a href="http://www.nature.com/neuro/journal/v20/n6/full/nn.4550.html"><em>Paper</em></a></p>
<p>Savier E, Eglen SJ, Bathélémy A, Perraut M, Pfrieger FW, Lemke G, Reber M (2017) A molecular mechanism for the topographic alignment of convergent neural maps. eLife Sciences 6:e20470. <a href="http://dx.doi.org/10.7554/eLife.20470"><em>Paper</em></a> <a href="https://github.com/michaelreber/3-step-Map-Aligment-Model/"><em>Info</em></a></p>
</section>
<section id="section-9" class="level3">
<h3 class="anchored" data-anchor-id="section-9">2016</h3>
<p>Perez-Riverol Y, Gatto L, Wang R, Sachsenberg T, Uszkoreit J, da Veiga Leprevost F, Fufezan C, Ternent T, Eglen SJ, Katz DS, Pollard TJ, Konovalov A, Flight RM, Blin K, Vizcaino JA (2016) Ten simple rules for taking advantage of git and github. PLoS Comput Biol 12:e1004947. <a href="http://dx.doi.org/10.1371/journal.pcbi.1004947"><em>Paper</em></a> <a href="https://github.com/ypriverol/github-paper"><em>Info</em></a></p>
<p>Cotterill E, Charlesworth P, Thomas CW, Paulsen O, Eglen SJ (2016) A comparison of computational methods for detecting bursts in neuronal spike trains and their application to human stem cell-derived neuronal networks. J Neurophysiol 116:306-321. <a href="http://jn.physiology.org/content/116/2/306"><em>Paper</em></a> <a href="https://github.com/ellesec/burstanalysis"><em>Info</em></a> <!-- http://dx.doi.org/10.1152/jn.00093.2016  --> <!-- github archived at http://dx.doi.org/10.5281/zenodo.50312 --></p>
<p>Eglen SJ (2016) Bivariate spatial point patterns in the retina: a reproducible review. Journal de la Société Française de Statistique 157:33–48. <a href="http://journal-sfds.fr/article/view/518"><em>Paper</em></a> <a href="http://github.com/sje30/eglen2015"><em>Info</em></a></p>
<p>Gjorgjieva J, Evers JF, Eglen SJ (2016) Homeostatic activity-dependent tuning of recurrent networks for robust propagation of activity. J Neurosci 36:3722–3734. <a href="http://dx.doi.org/10.1523/JNEUROSCI.2511-15.2016"><em>Paper</em></a></p>
<p>Cotterill E, Hall D, Wallace K, Mundy WR, Eglen SJ, Shafer TJ (2016) Characterization of Early Cortical Neural Network Development in Multiwell Microelectrode Array Plates. J Biomol Screen 21:510-519 <a href="http://dx.doi.org/10.1177/1087057116640520"><em>Paper</em></a> <a href="http://github.com/sje30/EPAmeadev"><em>Info</em></a></p>
<p>Leiwe MN, Hendry AC, Bard AD, Eglen SJ, Lowe AS, Thompson ID (2016) Geniculo-cortical projection diversity revealed within the mouse visual thalamus. PLoS One 11:e0144846. <a href="http://dx.doi.org/10.1371/journal.pone.0144846"><em>Paper</em></a></p>
<p>Charlesworth P, Morton A, Eglen SJ, Komiyama NH, Grant SGN (2016) Canalization of genetic and pharmacological perturbations in developing primary neuronal activity patterns. Neuropharmacology 100:47–55. <a href="http://dx.doi.org/10.1016/j.neuropharm.2015.07.027"><em>Paper</em></a> <a href="http://damtp.cam.ac.uk/user/sje30/papers/charlesworth2015_data.pdf"><em>Info</em></a></p>
</section>
<section id="section-10" class="level3">
<h3 class="anchored" data-anchor-id="section-10">2015</h3>
<p>Hjorth JJJ, Savier E, Sterratt DC, Reber M, Eglen SJ (2015b) Estimating the location and size of retinal injections from orthogonal images of an intact retina. BMC Neurosci 16:80. <a href="http://dx.doi.org/10.1186/s12868-015-0217-8"><em>Paper</em></a> <a href="https://github.com/Hjorthmedh/IntactEye"><em>Info</em></a></p>
<p>Budd JML, Cuntz H, Eglen SJ, Krieger P (2015) Editorial: Quantitative Analysis of Neuroanatomy. Front Neuroanat 9:143. <a href="http://dx.doi.org/10.3389/fnana.2015.00143"><em>Paper</em></a></p>
<p>Hjorth JJJ, Sterratt DC, Cutts CS, Willshaw DJ, Eglen SJ (2015a) Quantitative assessment of computational models for retinotopic map formation. Dev Neurobiol 75:641–666. <a href="http://dx.doi.org/10.1002/dneu.22241"><em>Paper</em></a> <a href="https://github.com/Hjorthmedh/RetinalMap"><em>Info</em></a></p>
<p>Charlesworth P, Cotterill E, Morton A, Grant SGN, Eglen SJ (2015) Quantitative differences in developmental profiles of spontaneous activity in cortical and hippocampal cultures. Neural Dev 10:1. <a href="http://www.neuraldevelopment.com/content/10/1/1/"><em>Paper</em></a> <a href="https://github.com/sje30/g2chvc"><em>Info</em></a></p>
</section>
<section id="section-11" class="level3">
<h3 class="anchored" data-anchor-id="section-11">2014</h3>
<p>Cutts CS, Eglen SJ (2014) Detecting pairwise correlations in spike trains: an objective comparison of methods and application to the study of retinal waves. J Neurosci 34:14288–14303. <a href="http://dx.doi.org/10.1523/JNEUROSCI.2767-14.2014"><em>Paper</em></a> <a href="https://github.com/CCutts/Detecting_pairwise_correlations_in_spike_trains"><em>Info</em></a></p>
<p>Eglen S (2014a) Open access: sharing your data is easier than you think. Nature 510:340. <a href="http://www.damtp.cam.ac.uk/user/sje30/papers/eglen2014_correspondence.pdf"><em>Paper</em></a></p>
<p>Maccione A, Hennig MH, Gandolfo M, Muthmann O, van Coppenhagen J, Eglen SJ, Berdondini L, Sernagor E (2014) Following the ontogeny of retinal waves: pan-retinal recordings of population dynamics in the neonatal mouse. J Physiol 592:1545–1563. <a href="http://dx.doi.org/10.1113/jphysiol.2013.262840"><em>Paper</em></a> <a href="http://www.damtp.cam.ac.uk/user/sje30/waverepo"><em>Info</em></a></p>
<p>Eglen SJ (2014b) Retinotopic Development, Models of. In: Encyclopedia of Computational Neuroscience, pp 1–4. Springer New York. <a href="http://www.damtp.cam.ac.uk/user/sje30/papers/eglen2013_enc.pdf"><em>Paper</em></a> <a href="http://doi.org/10.1007/978-1-4614-6675-8_406">DOI</a></p>
<p>Schottdorf M, Eglen SJ, Wolf F, Keil W (2014) Can retinal ganglion cell dipoles seed iso-orientation domains in the visual cortex? PLoS One 9:e86139. <a href="http://dx.doi.org/10.1371/journal.pone.0086139"><em>Paper</em></a></p>
<p>Eglen SJ, Weeks M, Jessop M, Simonotto J, Jackson T, Sernagor E (2014) A data repository and analysis framework for spontaneous neural activity recordings in developing retina. Gigascience 3:3. <a href="http://dx.doi.org/10.1186/2047-217X-3-3"><em>Paper</em></a> <a href="http://github.com/sje30/waverepo"><em>Info</em></a></p>
</section>
<section id="section-12" class="level3">
<h3 class="anchored" data-anchor-id="section-12">2013</h3>
<p>Gjorgjieva J, Berni J, Evers JF, Eglen SJ (2013) Neural circuits for peristaltic wave propagation in crawling Drosophila larvae: analysis and modeling. Front Comput Neurosci 7:24. <a href="http://dx.doi.org/10.3389/fncom.2013.00024"><em>Paper</em></a></p>
</section>
<section id="section-13" class="level3">
<h3 class="anchored" data-anchor-id="section-13">2012</h3>
<p>Hore VRA, Troy JB, Eglen SJ (2012) Parasol cell mosaics are unlikely to drive the formation of structured orientation maps in primary visual cortex. Vis Neurosci 29:283–299. <a href="http://www.damtp.cam.ac.uk/user/sje30/papers/hore2012.pdf"><em>Paper</em></a> <!-- (http://dx.doi.org/10.1017/S0952523812000338)  --></p>
<p>Keeley PW, Sliff BJ, Lee SCS, Fuerst PG, Burgess RW, Eglen SJ, Reese BE (2012) Neuronal clustering and fasciculation phenotype in Dscam- and Bax-deficient mouse retinas. J Comp Neurol 520:1349–1364. <a href="http://dx.doi.org/10.1002/cne.23033"><em>Paper</em></a></p>
<p>Chabrol FP, Eglen SJ, Sernagor E (2012) GABAergic control of retinal ganglion cell dendritic development. Neuroscience 227:30–43. <a href="http://dx.doi.org/10.1016/j.neuroscience.2012.09.040"><em>Paper</em></a></p>
</section>
<section id="section-14" class="level3">
<h3 class="anchored" data-anchor-id="section-14">2011</h3>
<p>Gjorgjieva J, Eglen SJ (2011) Modeling developmental patterns of spontaneous activity. Curr Opin Neurobiol 21:679–684. <a href="http://ukpmc.ac.uk/articles/PMC3184139"><em>Paper</em></a></p>
</section>
<section id="section-15" class="level3">
<h3 class="anchored" data-anchor-id="section-15">2009</h3>
<p>Gjorgjieva J, Toyoizumi T, Eglen SJ (2009) Burst-time-dependent plasticity robustly guides ON/OFF segregation in the lateral geniculate nucleus. PLoS Comput Biol 5:e1000618. <a href="http://www.ploscompbiol.org/doi/pcbi.1000618"><em>Paper</em></a></p>
<p>Godfrey KB, Eglen SJ, Swindale NV (2009) A multi-component model of the developing retinocollicular pathway incorporating axonal and synaptic growth. PLoS Comput Biol 5:e1000600. <a href="http://www.ploscompbiol.org/doi/pcbi.1000600"><em>Paper</em></a></p>
<p>Eglen SJ (2009) A Quick Guide to Teaching R Programming to Computational Biology Students. PLoS Comput Biol 5:e1000482. <a href="http://www.ploscompbiol.org/doi/pcbi.1000482"><em>Paper</em></a></p>
</section>
<section id="section-16" class="level3">
<h3 class="anchored" data-anchor-id="section-16">2008</h3>
<p>Eglen SJ, Lofgreen DD, Raven MA, Reese BE (2008) Analysis of spatial relationships in three dimensions: tools for the study of nerve cell patterning. BMC Neurosci 9:68. <a href="http://www.biomedcentral.com/1471-2202/9/68"><em>Paper</em></a></p>
<p>Eglen SJ, Wong JCT (2008) Spatial constraints underlying the retinal mosaics of two types of horizontal cells in cat and macaque. Vis Neurosci 25:209–214. <a href="http://arxiv.org/pdf/1208.0986.pdf"><em>Paper</em></a></p>
</section>
<section id="section-17" class="level3">
<h3 class="anchored" data-anchor-id="section-17">2006</h3>
<p>Eglen SJ (2006) Development of regular cellular spacing in the retina: theoretical models. Math Med Biol 23:79–99. <a href="http://www.damtp.cam.ac.uk/user/sje30/papers/eglen2006.pdf"><em>Paper</em></a></p>
<p>Sernagor E, Eglen SJ, Harris WA, Wong ROL eds.&nbsp;(2006) Retinal Development. Cambridge University Press.</p>
</section>
<section id="section-18" class="level3">
<h3 class="anchored" data-anchor-id="section-18">2005</h3>
<p>Eglen SJ, Diggle PJ, Troy JB (2005) Homotypic constraints dominate positioning of on- and off-center beta retinal ganglion cells. Vis Neurosci 22:859–871. <a href="http://www.damtp.cam.ac.uk/user/sje30/papers/eglen2005.pdf"><em>Paper</em></a></p>
<p>Kishi M, Kummer TT, Eglen SJ, Sanes JR (2005) LL5beta: a regulator of postsynaptic differentiation identified in a screen for synaptically enriched transcripts at the neuromuscular junction. J Cell Biol 169:355–366. <a href="http://www.damtp.cam.ac.uk/user/sje30/papers/kishi2005.pdf"><em>Paper</em></a></p>
</section>
<section id="section-19" class="level3">
<h3 class="anchored" data-anchor-id="section-19">2003</h3>
<p>Eglen SJ, Raven MA, Tamrazian E, Reese BE (2003b) Dopaminergic amacrine cells in the inner nuclear layer and ganglion cell layer comprise a single functional retinal mosaic. J Comp Neurol 466:343–355. <a href="http://www.damtp.cam.ac.uk/user/sje30/papers/eglen2003.pdf"><em>Paper</em></a></p>
<p>Sernagor E, Young C, Eglen SJ (2003) Developmental Modulation of Retinal Wave Dynamics: Shedding Light on the GABA Saga. J Neurosci 23:7621–7629. <a href="http://www.damtp.cam.ac.uk/user/sje30/papers/sernagor2003_jn.pdf"><em>Paper</em></a></p>
<p>Raven MA, Eglen SJ, Ohab JJ, Reese BE (2003) Determinants of the exclusion zone in dopaminergic amacrine cell mosaics. J Comp Neurol 461:123–136. <a href="http://www.damtp.cam.ac.uk/user/sje30/papers/raven2003.pdf"><em>Paper</em></a></p>
<p>Eglen SJ, Galli-Resta L, Reese BE (2003a) Theoretical models of retinal mosaic formation. In: Modeling neural development (van Ooyen A, ed), pp 133–150. MIT Press.</p>
<p>Demas J, Eglen SJ, Wong ROL (2003) Developmental loss of synchronous spontaneous activity in the mouse retina is independent of visual experience. J Neurosci 23:2851–2860. <a href="http://www.jneurosci.org/cgi/pmidlookup?view=long&amp;pmid=12684472"><em>Paper</em></a></p>
</section>
<section id="section-20" class="level3">
<h3 class="anchored" data-anchor-id="section-20">2002</h3>
<p>Lee CW, Eglen SJ, Wong ROL (2002) Segregation of on and off Retinogeniculate Connectivity Directed by Patterned Spontaneous Activity. J Neurophysiol 88:2311–2321. <a href="http://jn.physiology.org/cgi/reprint/88/5/2311"><em>Paper</em></a> <a href="http://jn.physiology.org/cgi/content/full/88/5/2311/DC1"><em>Info</em></a></p>
</section>
<section id="section-21" class="level3">
<h3 class="anchored" data-anchor-id="section-21">2000</h3>
<p>Eglen SJ, van Ooyen A, Willshaw DJ (2000) Lateral cell movement driven by dendritic interactions is sufficient to form retinal mosaics. Network 11:103–118. <a href="http://www.damtp.cam.ac.uk/user/sje30/papers/eglen2000.pdf"><em>Paper</em></a> <a href="http://www.damtp.cam.ac.uk/user/sje30/mosaics/index.html"><em>Info</em></a></p>
<p>Sernagor E, Eglen SJ, O’Donovan MJ (2000) Differential Effects of Acetylcholine and Glutamate Blockade on the Spatiotemporal Dynamics of Retinal Waves. J Neurosci 20:RC56. <a href="http://www.jneurosci.org/cgi/content/abstract/20/2/RC56"><em>Paper</em></a> <a href="http://www.damtp.cam.ac.uk/user/sje30/chick-waves/index.html"><em>Info</em></a></p>
</section>
<section id="section-22" class="level3">
<h3 class="anchored" data-anchor-id="section-22">1999</h3>
<p>Eglen SJ (1999) The role of retinal waves and synaptic normalization in retinogeniculate development. Philos Trans R Soc Lond B Biol Sci 354:497–506. <a href="http://www.damtp.cam.ac.uk/user/sje30/papers/eglen1999.pdf"><em>Paper</em></a></p>
</section>
<section id="section-23" class="level3">
<h3 class="anchored" data-anchor-id="section-23">1997</h3>
<p>Eglen S, Bray A, Stone J (1997) Unsupervised discovery of invariances. Network: Computation in Neural Systems 8:441–452. <a href="http://doi.org/10.1088/0954-898X_8_4_006"><em>Paper</em></a></p>
</section>
<section id="section-24" class="level3">
<h3 class="anchored" data-anchor-id="section-24">1996</h3>
<p>Tate AR, Watson D, Eglen S, Arvanitis TN, Thomas EL, Bell JD (1996) Automated feature extraction for the classification of human in vivo13C NMR spectra using statistical pattern recognition and wavelets. Magn Reson Med 35:834–840. <a href="https://paperpile.com/app/p/a0aac56b-3a3c-002c-b201-438556b845fd"><em>Paper</em></a></p>
<!-- Bowns L, Eglen SJ (1994) Extraction of non-fourier orientation information for texture classification. Investigative Opthalmology and Visual Science 35:1406. -->


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>